# Chapter 6, 데이터 베이스

Created: July 27, 2021

데이터베이스 시스템은 이름 그대로 데이터를 저장 및 보존하는 시스템. 저장되어 있는 데이터를 읽어 들일 수 있으며, 또한 새로운 데이터를 저장할 수도 있고, 기존의 데이터를 업데이트 할 수도 있다.

일반적으로 데이터베이스 시스템에는 크게 2가지 종류가 있음.

- 관계형 데이터베이스 시스템(RDBMS, Relational Database Managment System)
- 비관계형 데이터 베이스(NoSQL)

## 관계형 데이터베이스

관계형 데이터란 데이터들이 서로 상호관련성을 가진 형태로 표현한 데이터를 말한다. 대표적인 관계형 데이터베이스 시스템에는 MySQL과 PostgreSQL등이 있다.

관계형 데이터베이스에서 모든 데이터들은 2차원 테이블로 표현되고 각각의 테이블은 칼럼과 로우로 구성된다. 각 로우는 자신만의 고유 키를 가지게 되는데 이를 통해 해당 로우를 찾거나 인용하게 된다.

### 테이블들의 상호 관련성 종류

테이블끼리의 연결에는 크게 다음과 같은 3가지 종류가 있음

- One to One
    
    테이블 A의 로우와 테이블B의 로우가 정확히 일대일 매칭되는 관계(ex: 국가와 수도)
    
- One to Many
    
    테이블A의 로우가 테이블B의 여러 로우와 연결되는 관계(ex: 하나의 사용자가 여러 트윗 작성)
    
- Many to Many
    
    테이블A의 여러 로우가 테이블 B의 여러 로우와 연결되는 관계(ex: 트위터 내 팔로우 관계)
    

### 정규화

이러한 관계들을 나타내는 테이블간에 정보들을 여러 테이블로 나누어서 저장할 필요가 있을까?

한 테이블에 필요한 정보를 전부 저장하면 더 간단하고 관리하기도 편하지 않을까? 

**Problem1: 하나의 테이블에 모든 정보를 다 넣으면 동일한 정보들이 불필요하게 중복되어 저장**

즉 테이블의 일부 정보가 다른 테이블에서도 사용된다면 불필요하게 더 많은 디스크를 사용하게 되어진다. 하지만 외부 키로 연결하여 사용한다면 단순히 키 값만 저장하면 되므로, 디스크 공간을 훨씬 효율적으로 사용할 수 있게 된다.

**Problem2: 관계형식으로 데이터베이스 구조를 잡지 않고 필요한 데이터를 테이블에 저장하게 되면 잘못된 데이터가 저장될 가능성이 높아진다.** 

테이블들 간에 같은 정보이지만 오류로 서로 다르게 입력되었을 경우, 외부키를 사용하여 부분적으로 오류가 생기는 문제를 최소화 시켜준다. 

이렇게 중복을 최소화하게 데이터를 구조화하는 프로세스를 정규화 혹은 Normalization이라 한다.

### 트랜잭션(Transaction)

트랜잭션은 일련의 작업들이 마치 하나의 작업처럼 취급되어서 모두 다 성공하거나 아니면 모두 다 실패하는 것을 말한다. 작업을 처리하기 위한 일련의 연속적인 과정들이 모두 제대로 실행되었을 떄만 실제 데이터베이스에 영구적으로 반영되고 만일 중간 과정에서 오류가 나거나 실패하는 경우 그 전 상태로 돌아가는 기능이 데이터베이스 트랜잭션이다.

## 비관계형 데이터베이스

비관계형 타입의 데이터를 저장할 떄 주로 사용되는 데이터베이스 시스템이다. 관계형 데이터베이스와 다르게 비관계형이므로 데이터들을 저장하기 전에 정의할 필요가 없다. 즉 테이블들의 스키마를 관계를 미리 구현해야 하는 필요 없이 데이터가 들어오는 그대로 저장하게 된다. 대표적인 NoSQL 데이터베이스 시스템에는 MongoDB, Redis, Cassandra 등이 있다.

## 관계형 데이터베이스 시스템 vs 비관계형 데이터베이스 시스템

<aside>
💡 **관계형 데이터베이스 시스템 장점**
- 데이터를 효율적이고 체계적으로 저장하고 관리할 수 있음
- 테이블들의 구조를 정의함으로써 데이터의 완전성 보장
- 트랜잭션 기능을 제공

**관경형 데이터베이스 시스템 단점**
- 테이블을 미리 정의해야 하므로 테이블 구조 변화 등에 유연하지 못함
- 테이블 구조가 미리 정의되어야 하고 ACID를 보장해야 해서 확장이 쉽지 않다.
- 서버를 늘려서 분산 저장하는 것이 쉽지 않다. 스케일 아웃(서버수 확장)보다는 스케일 업(서버 성능 높임)으로 확장해야 한다.

</aside>

<aside>
💡 **비관계형 데이터베이스 시스템 장점**
- 데이터 구조를 미리 정의하지 않아도 되므로 저장하는 데이터 구조의 변화에 유연함
- 데이터베이스 시스템 확장하기가 비교적 쉽다. 스케일 아웃 방식으로 시스템 확장이 가능
- 확장하기가 쉽고, 데이터의 구조도 유연하다 보니 방대한 양의 데이터를 저장하는데 유리하다.

**비관계형 데이터베이스 시스템 단점**
- 데이터의 완전성이 덜 보장된다.
- 트랜잭션이 안 되거나 되더라도 비교적으로 불안정한다.

</aside>

## SQL

SQL은 관계형 데이터베이스에서 데이터를 읽거나 생성 및 수정하기 위해 사용되는 언어다. 기본적으로 CRUD라고 하여 Create, Read, Update, Delete하는 기능을 제공하는 관계형 데이터베이스 시스템 전용 언어다.

### Simple Usecase

```sql
# Select
SELECT column1 FROM table_name

# Insert
INSERT INTO table_name (column1, column2) VALUES (col1_value, col2_value)

# Update
UPDATE table_name SET column1=value1 WHERE column2=value2

# Delete
DELETE FROM table_name WHERE column=value

# JOIN
SELECT table.column1, table2.column2
FROM table1
JOIN table2
ON table1.id = table2.id
```